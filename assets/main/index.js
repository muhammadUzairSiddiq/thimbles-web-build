System.register("chunks:///_virtual/CupShuffleGame.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(i){var e,t,n,l,a,s,o,r,c,u,h,p,f,d,b,g,C,v,m,w,y,S;return{setters:[function(i){e=i.applyDecoratedDescriptor,t=i.inheritsLoose,n=i.initializerDefineProperty,l=i.assertThisInitialized},function(i){a=i.cclegacy,s=i._decorator,o=i.Node,r=i.Label,c=i.Color,u=i.Canvas,h=i.view,p=i.input,f=i.Input,d=i.math,b=i.Camera,g=i.UITransform,C=i.Graphics,v=i.Vec3,m=i.tween,w=i.Sprite,y=i.Button,S=i.Component}],execute:function(){var x,I,A,k,z,P,L,O,R,E,T,D,U,F,j,G,H,M,N,J,B,_,W,Y,V,K,X,q,Z,Q,$,ii,ei,ti,ni,li,ai,si,oi,ri,ci;a._RF.push({},"9e1e3FM8WZIz5UCh8q5wshU","CupShuffleGame",void 0);var ui=s.ccclass,hi=s.property;i("CupShuffleGame",(x=ui("CupShuffleGame"),I=hi([o]),A=hi([o]),k=hi(o),z=hi(o),P=hi(r),L=hi(r),O=hi([o]),R=hi(c),E=hi(c),x((U=e((D=function(i){function e(){for(var e,t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return e=i.call.apply(i,[this].concat(a))||this,n(e,"cups",U,l(e)),n(e,"hands",F,l(e)),n(e,"ball",j,l(e)),n(e,"ball2",G,l(e)),n(e,"resultLabel",H,l(e)),n(e,"coinLabel",M,l(e)),n(e,"enableDoubleBalls",N,l(e)),n(e,"startingCoins",J,l(e)),n(e,"swapsPerRound",B,l(e)),n(e,"swapSpeed",_,l(e)),n(e,"handGrabHeight",W,l(e)),n(e,"idleAnimationAmplitude",Y,l(e)),n(e,"idleAnimationSpeed",V,l(e)),n(e,"jarLiftHeight",K,l(e)),n(e,"jarTiltAngle",X,l(e)),n(e,"liftExtras",q,l(e)),n(e,"ballRevealDuration",Z,l(e)),n(e,"ballYPosition",Q,l(e)),n(e,"clickCalibrationOffsetX",$,l(e)),n(e,"clickCalibrationOffsetY",ii,l(e)),n(e,"jar0ClickAreaLeft",ei,l(e)),n(e,"jar0ClickAreaRight",ti,l(e)),n(e,"jar1ClickAreaLeft",ni,l(e)),n(e,"jar1ClickAreaRight",li,l(e)),n(e,"jar2ClickAreaLeft",ai,l(e)),n(e,"jar2ClickAreaRight",si,l(e)),n(e,"showClickableAreas",oi,l(e)),n(e,"highlightColor",ri,l(e)),n(e,"clickableAreaColor",ci,l(e)),e.ballIndex=1,e.ballCup=null,e.ballJarName="",e.ball2Index=-1,e.ball2Cup=null,e.ball2JarName="",e.isShuffling=!1,e.waitingForInput=!1,e.consecutiveWins=0,e.currentCoins=0,e.baseSwapsPerRound=2,e.baseSwapSpeed=.35,e.idleTweens=[],e.demoShown=!1,e.highlightedCup=null,e.clickProcessed=!1,e.clickableAreaGraphics=[],e}t(e,i);var a=e.prototype;return a.onLoad=function(){this.setupResponsiveCanvas()},a.setupResponsiveCanvas=function(){var i,e=null==(i=this.node.scene)?void 0:i.getComponentInChildren(u);if(e){e.fitHeight=!0,e.fitWidth=!0;var t=h.getVisibleSize(),n=h.getDesignResolutionSize();if(console.log("Canvas Setup - Screen: "+t.width+"x"+t.height+", Design: "+n.width+"x"+n.height),"undefined"!=typeof screen&&screen.orientation)try{screen.orientation.lock("portrait").catch((function(){}))}catch(i){}}else console.warn("No Canvas found for responsive setup")},a.start=function(){for(var i=this,e=0;e<this.hands.length;e++)this.hands[e]&&(this.hands[e].initialPosition=this.hands[e].position.clone());if(this.updateMobilePortraitLayout(),this.setupCupListeners(),this.setupClickableAreaVisualization(),h.on("canvas-resize",this.onScreenResize,this),this.resultLabel&&(this.resultLabel.string=""),this.ball&&(this.ball.active=!1),this.ball2&&(this.ball2.active=!1),this.setLiftExtrasActive(!1),this.currentCoins=0,this.updateCoinDisplay(),this.baseSwapsPerRound=this.swapsPerRound,this.baseSwapSpeed=this.swapSpeed,!this.cups.length)return this.resultLabel&&(this.resultLabel.string="ERROR: Assign cups in editor!"),void console.error("CupShuffleGame: Cups array is empty! Please assign cups in Cocos Creator editor.");console.log("CupShuffleGame: Initialized with",this.cups.length,"cups"),this.randomizeJarPositions(),this.startIdleAnimations(),p.on(f.EventType.TOUCH_END,this.onGlobalTouch,this),p.on(f.EventType.MOUSE_UP,this.onGlobalMouse,this),this.scheduleOnce((function(){console.log("Auto-starting game..."),i.onStart(!0)}),.5)},a.onScreenResize=function(){this.updateMobilePortraitLayout(),this.setupClickableAreaVisualization()},a.updateMobilePortraitLayout=function(){var i,e=h.getVisibleSize(),t=h.getDesignResolutionSize(),n=null==(i=this.node.scene)?void 0:i.getComponentInChildren(u);if(n&&(n.fitHeight=!0,n.fitWidth=!0),e.height>0&&t.height>0){var l=Math.min(e.width/t.width,e.height/t.height);console.log("Portrait Layout - Screen: "+e.width.toFixed(0)+"x"+e.height.toFixed(0)+", Design: "+t.width.toFixed(0)+"x"+t.height.toFixed(0)+", Scale: "+l.toFixed(2))}},a.randomizeJarPositions=function(){if(0!==this.cups.length){for(var i=[],e=0;e<this.cups.length;e++)this.cups[e]&&i.push(this.cups[e].position.clone());for(var t=i.length-1;t>0;t--){var n=d.randomRangeInt(0,t+1),l=[i[n],i[t]];i[t]=l[0],i[n]=l[1]}for(var a=0;a<this.cups.length;a++)this.cups[a]&&i[a]&&(this.cups[a].setPosition(i[a]),console.log("Jar "+this.cups[a].name+" moved to position:",i[a]));console.log("Jar positions randomized at game start")}},a.onDestroy=function(){p.off(f.EventType.TOUCH_END,this.onGlobalTouch,this),p.off(f.EventType.MOUSE_UP,this.onGlobalMouse,this),h.off("canvas-resize",this.onScreenResize,this)},a.onGlobalTouch=function(i){0===i.getID()&&(this.clickProcessed=!1);var e=i.getLocation();console.log("Global TOUCH_END at: "+e.x+", "+e.y+", waitingForInput: "+this.waitingForInput+", isShuffling: "+this.isShuffling),!this.waitingForInput||this.isShuffling||this.clickProcessed?console.log("Global touch ignored - not ready or already processed"):this.checkGlobalClick(e)},a.onGlobalMouse=function(i){this.clickProcessed=!1;var e=i.getLocation();console.log("Global MOUSE_UP at: "+e.x+", "+e.y+", waitingForInput: "+this.waitingForInput+", isShuffling: "+this.isShuffling),!this.waitingForInput||this.isShuffling||this.clickProcessed?console.log("Global mouse ignored - not ready or already processed"):this.checkGlobalClick(e)},a.checkGlobalClick=function(i){var e,t=null==(e=this.node.scene)?void 0:e.getComponentInChildren(u);if(t&&(t.cameraComponent||b.main))for(var n=h.getVisibleSize(),l=h.getDesignResolutionSize(),a=i.x/n.width,s=i.y/n.height,o=(a-.5)*l.width,r=(.5-s)*l.height,c=this.cups.length-1;c>=0;c--){var p=this.cups[c];if(p&&p.active){var f=p.getComponent(g);if(f){var d=p.position,C=f.contentSize,v=f.anchorPoint,m=p.scale,w=C.width*m.x,y=C.height*m.y,S=d.x-w*v.x,x=d.x+w*(1-v.x),I=d.y-y*v.y,A=d.y+y*(1-v.y);if(0===c?(S+=this.jar0ClickAreaLeft,x+=this.jar0ClickAreaRight):1===c?(S+=this.jar1ClickAreaLeft,x+=this.jar1ClickAreaRight):2===c&&(S+=this.jar2ClickAreaLeft,x+=this.jar2ClickAreaRight),o>=S&&o<=x&&(r>=I&&r<=A))return console.log("âœ“ Global touch on jar "+c+" ("+p.name+") - UI: ("+o.toFixed(1)+", "+r.toFixed(1)+"), Jar: ("+d.x.toFixed(1)+", "+d.y.toFixed(1)+"), Bounds: L:"+S.toFixed(1)+" R:"+x.toFixed(1)+" B:"+I.toFixed(1)+" T:"+A.toFixed(1)+")"),this.clickProcessed=!0,void this.onCupClicked(c,null)}}}},a.setupCupListeners=function(){for(var i=this,e=function(){var e=i.cups[t];if(!e)return 1;e.active=!0;var n=e.getComponent(g);if(n||(n=e.addComponent(g)),n){var l=e.getComponent(w);if(l&&l.spriteFrame){var a=l.spriteFrame.rect,s=n.contentSize;(Math.abs(s.width-a.width)>10||Math.abs(s.height-a.height)>10)&&(n.setContentSize(a.width,a.height),console.log("Cup "+t+": Updated UITransform size to "+a.width+"x"+a.height))}}e.cupIndex=t;var r=t,c=function(){console.log("Cup "+r+" clicked! waitingForInput: "+i.waitingForInput+", isShuffling: "+i.isShuffling),!i.waitingForInput||i.isShuffling||i.clickProcessed?console.log("Cup "+r+" click ignored - not ready for input or already processed"):(i.clickProcessed=!0,console.log("Cup "+r+" clicked! Processing..."),i.onCupClicked(r,null))},u=e.getComponent(y);if(u)console.log("Cup "+t+": Using Button component for click detection"),u.node.off(y.EventType.CLICK),u.node.on(y.EventType.CLICK,c,i),u.interactable=!0;else{console.log("Cup "+t+": Using touch/mouse events for click detection"),e.off(o.EventType.TOUCH_START),e.off(o.EventType.TOUCH_END),e.off(o.EventType.TOUCH_MOVE),e.off(o.EventType.TOUCH_CANCEL),e.off(o.EventType.MOUSE_DOWN),e.off(o.EventType.MOUSE_UP),e.off(o.EventType.MOUSE_ENTER),e.off(o.EventType.MOUSE_LEAVE),e.on(o.EventType.TOUCH_END,c,i),e.on(o.EventType.MOUSE_UP,c,i);!function e(t){for(var n=0;n<t.children.length;n++){var l=t.children[n];l&&(l.off(o.EventType.TOUCH_END),l.off(o.EventType.MOUSE_UP),l.on(o.EventType.TOUCH_END,c,i),l.on(o.EventType.MOUSE_UP,c,i),e(l))}}(e)}var h=n?n.contentSize.width+"x"+n.contentSize.height:"none";console.log("Cup "+t+" listener setup complete. UITransform size: "+h+", Active: "+e.active)},t=0;t<this.cups.length;t++)e()},a.setupClickableAreaVisualization=function(){for(var i,e=0;e<this.clickableAreaGraphics.length;e++)this.clickableAreaGraphics[e]&&this.clickableAreaGraphics[e].node&&this.clickableAreaGraphics[e].node.destroy();if(this.clickableAreaGraphics=[],this.showClickableAreas){var t=null==(i=this.node.scene)?void 0:i.getComponentInChildren(u);if(t)for(var n=t.node,l=0;l<this.cups.length;l++){var a=this.cups[l];if(a&&a.active){var s=a.getComponent(g);if(s){var r=a.worldPosition,c=new o("ClickableArea_"+l);c.setParent(n),c.setPosition(r);var h=c.addComponent(C);this.clickableAreaGraphics.push(h);var p=s.contentSize,f=s.anchorPoint,d=a.scale,b=p.width*d.x,v=p.height*d.y,m=-b*f.x,w=b*(1-f.x),y=-v*f.y;f.y;0===l?(m+=this.jar0ClickAreaLeft,w+=this.jar0ClickAreaRight):1===l?(m+=this.jar1ClickAreaLeft,w+=this.jar1ClickAreaRight):2===l&&(m+=this.jar2ClickAreaLeft,w+=this.jar2ClickAreaRight);var S=w-m;h.strokeColor=this.clickableAreaColor,h.fillColor=this.clickableAreaColor,h.lineWidth=2,h.rect(m,y,S,v),h.fill(),h.stroke(),c.setSiblingIndex(0)}}}}},a.onStart=function(i){var e=this;if(void 0===i&&(i=!1),console.log("onStart called!","isShuffling:",this.isShuffling,"waitingForInput:",this.waitingForInput,"cups:",this.cups.length),this.isShuffling||this.waitingForInput)console.log("Cannot start - already shuffling or waiting for input");else{if(!this.cups.length)return this.resultLabel&&(this.resultLabel.string="ERROR: No cups assigned!"),void console.error("CupShuffleGame: Cannot start - cups array is empty!");console.log("Starting shuffle..."),this.stopIdleAnimations(),this.isShuffling=!0,this.waitingForInput=!1,this.resultLabel&&(this.resultLabel.string=""),this.clearHighlights(),this.setLiftExtrasActive(!1),this.ball&&(this.ball.active=!1),this.ball2&&(this.ball2.active=!1);for(var t=-1,n=null,l=0;l<this.cups.length;l++){var a=this.cups[l];if(a)if(a.name.toLowerCase().trim().includes("001")){t=l,n=a;break}}if(-1===t&&(t=0,n=this.cups[0],console.warn("Jar 001 not found by name, using first cup as fallback")),this.ballIndex=t,this.ballCup=n,this.ballJarName=n?n.name:"",this.placeBallUnderCup(this.ballIndex),console.log('Ball placed in jar 001: name="'+this.ballJarName+'", index='+this.ballIndex),this.enableDoubleBalls&&this.ball2){for(var s=-1,o=0;o<this.cups.length;o++){var r=this.cups[o];if(r&&r!==n&&!r.name.includes("001")){s=o;break}}if(-1===s)for(var c=0;c<this.cups.length;c++)if(c!==t){s=c;break}s>=0?(this.ball2Index=s,this.ball2Cup=this.cups[this.ball2Index],this.ball2JarName=this.ball2Cup?this.ball2Cup.name:"",this.placeBall2UnderCup(this.ball2Index),console.log('Second ball placed in: name="'+this.ball2JarName+'", index='+this.ball2Index)):(this.ball2Index=-1,this.ball2Cup=null,this.ball2JarName="")}else this.ball2Index=-1,this.ball2Cup=null,this.ball2JarName="";if(this.updateDifficulty(),!i||this.demoShown)this.shuffleCups(this.swapsPerRound,(function(){e.isShuffling=!1,e.startIdleAnimations(),e.waitingForInput=!0,e.clickProcessed=!1,e.resultLabel&&(e.resultLabel.string=""),e.updateCoinDisplay(),console.log("Shuffling complete! Waiting for cup click. Ball is under cup index:",e.ballIndex)}));else{this.demoShown=!0,this.waitingForInput=!1,this.isShuffling=!1;var u=this.ballIndex;this.liftJarAndReveal(u,u,!0,(function(){e.isShuffling=!1,e.waitingForInput=!1,e.onStart(!1)}),!1,!1,!1)}}},a.onCupClicked=function(i,e){console.log("onCupClicked called! Cup: "+i+", waitingForInput: "+this.waitingForInput+", isShuffling: "+this.isShuffling),this.waitingForInput?this.isShuffling?console.log("Ignoring click - still shuffling"):i<0||i>=this.cups.length?console.log("Invalid cup index:",i):(this.waitingForInput=!1,this.highlightCup(this.cups[i]),console.log("Processing click on cup "+i),this.checkAnswer(i)):console.log("Ignoring click - not waiting for input")},a.checkAnswer=function(i){this.waitingForInput=!1;var e=this.cups[i];if(e){var t=e.name,n=t.toLowerCase().trim().includes("001"),l=!1;if(this.enableDoubleBalls){var a=this.ball2JarName&&t===this.ball2JarName;l=n||a}else l=n;var s=-1;if(this.ballJarName)for(var o=0;o<this.cups.length;o++)if(this.cups[o]&&(this.cups[o].name===this.ballJarName||this.cups[o].name.includes("001"))){s=o;break}-1===s&&(s=this.ballIndex),console.log('Answer check: clicked jar name="'+t+'", is jar 001='+n+', ball jar name="'+this.ballJarName+'", isCorrect='+l),l||(this.consecutiveWins=0,this.resetDifficulty(),this.currentCoins=0,this.updateCoinDisplay()),this.liftJarAndReveal(i,s,l,void 0,!0,!0,!0)}else console.error("Clicked cup not found at index:",i)},a.liftJarAndReveal=function(i,e,t,n,l,a,s){var o=this;void 0===l&&(l=!0),void 0===a&&(a=!0),void 0===s&&(s=!1);var r=this.cups[i];if(r){this.stopIdleAnimations(),this.setLiftExtrasActive(!0);var c=r.position.clone(),u=function(i){var e=i.getComponent(g);if(e){var t=e.contentSize,n=e.anchorPoint,l=i.worldScale;return i.position.y+t.height*(1-n.y)*l.y}return i.position.y+50}(r),h=new v(c.x,u+this.handGrabHeight,c.z),p=this.jarLiftHeight,f=new v(c.x,c.y+p,c.z),b=r.eulerAngles.clone(),C=new v(b.x,b.y,b.z+this.jarTiltAngle),w=null,y=0;if(this.hands.length>=2){for(var S=[],x=0;x<this.cups.length;x++)this.cups[x]&&S.push(this.cups[x].position.x);S.sort((function(i,e){return i-e}));var I=c.x,A=I===S[0],k=I===S[S.length-1],z=!A&&!k,P=this.hands[0],L=this.hands[1],O=P?P.position.x:0,R=L?L.position.x:0;if(z)y=d.randomRangeInt(0,2),w=0===y?P:L,console.log("Center jar clicked - randomly using "+(0===y?"left":"right")+" hand");else Math.abs(I-O)<Math.abs(I-R)?(w=P,y=0,console.log("Using left hand (closer to jar at x: "+I+")")):(w=L,y=1,console.log("Using right hand (closer to jar at x: "+I+")"))}else 1===this.hands.length&&(w=this.hands[0],y=0);var E=w?w.initialPosition||w.position.clone():null,T=.5,D=.4;if(w)m(w).to(.35,{position:h},{easing:"cubicOut"}).start(),this.scheduleOnce((function(){var u=m(r).to(T,{position:f,eulerAngles:C},{easing:"cubicOut"}),d=new v(h.x,h.y+p,h.z),g=m(w).to(T,{position:d},{easing:"cubicOut"});u.start(),g.start(),o.scheduleOnce((function(){if(t){if(o.ball&&o.ballCup&&r===o.ballCup){var u=new v(f.x,o.ballYPosition,f.z);o.ball.setPosition(u),o.ball.active=!0,o.scheduleOnce((function(){o.ball&&(o.ball.active=!1)}),o.ballRevealDuration)}if(o.enableDoubleBalls&&o.ball2&&o.ball2Cup&&r===o.ball2Cup){var h=new v(f.x,o.ballYPosition-20,f.z);o.ball2.setPosition(h),o.ball2.active=!0,o.scheduleOnce((function(){o.ball2&&(o.ball2.active=!1)}),o.ballRevealDuration)}}t&&s?(o.consecutiveWins++,0===o.currentCoins?o.currentCoins=2:o.currentCoins*=2,o.updateCoinDisplay()):t&&o.consecutiveWins++,o.scheduleOnce((function(){var s=m(r).to(D,{position:c,eulerAngles:b},{easing:"cubicIn"});w&&E&&m(w).to(D,{position:E},{easing:"cubicIn"}).start();s.start(),o.scheduleOnce((function(){var s=0;!function i(){if(!(s>=4)){var e=8*(Math.random()-.5),t=8*(Math.random()-.5)*.6,n=new v(c.x+e,c.y+t,c.z);m(r).to(.1,{position:n},{easing:"sineInOut"}).to(.1,{position:c},{easing:"sineInOut"}).call((function(){++s<4&&i()})).start()}}(),o.scheduleOnce((function(){if(t&&(o.ball&&o.ballCup&&r===o.ballCup&&(o.placeBallUnderCup(i),o.ball.active=!0),o.enableDoubleBalls&&o.ball2&&o.ball2Cup&&r===o.ball2Cup&&(o.placeBall2UnderCup(i),o.ball2.active=!0)),t||!a){o.ball&&(o.ball.active=!1),o.setLiftExtrasActive(!1);n?n():l&&(t?o.scheduleOnce((function(){o.onStart(!1)}),.5):(o.consecutiveWins=0,o.resetDifficulty(),o.scheduleOnce((function(){o.onStart(!1)}),1)))}else o.liftJarAndReveal(e,e,!0,n,l,!1)}),.9)}),D)}),.6)}),T)}),.35);else m(r).to(T,{position:f,eulerAngles:C},{easing:"cubicOut"}).start(),this.scheduleOnce((function(){if(t){if(o.ball&&o.ballCup&&r===o.ballCup){var u=new v(f.x,o.ballYPosition,f.z);o.ball.setPosition(u),o.ball.active=!0,o.scheduleOnce((function(){o.ball&&(o.ball.active=!1)}),o.ballRevealDuration)}if(o.enableDoubleBalls&&o.ball2&&o.ball2Cup&&r===o.ball2Cup){var h=new v(f.x,o.ballYPosition-20,f.z);o.ball2.setPosition(h),o.ball2.active=!0,o.scheduleOnce((function(){o.ball2&&(o.ball2.active=!1)}),o.ballRevealDuration)}}t&&s?(o.consecutiveWins++,0===o.currentCoins?o.currentCoins=2:o.currentCoins*=2,o.updateCoinDisplay()):t&&o.consecutiveWins++,o.scheduleOnce((function(){m(r).to(D,{position:c,eulerAngles:b},{easing:"cubicIn"}).start(),o.scheduleOnce((function(){var s=0;!function i(){if(!(s>=4)){var e=8*(Math.random()-.5),t=8*(Math.random()-.5)*.6,n=new v(c.x+e,c.y+t,c.z);m(r).to(.1,{position:n},{easing:"sineInOut"}).to(.1,{position:c},{easing:"sineInOut"}).call((function(){++s<4&&i()})).start()}}(),o.scheduleOnce((function(){if(t&&(o.ball&&o.ballCup&&r===o.ballCup&&(o.placeBallUnderCup(i),o.ball.active=!0),o.enableDoubleBalls&&o.ball2&&o.ball2Cup&&r===o.ball2Cup&&(o.placeBall2UnderCup(i),o.ball2.active=!0)),t||!a){o.ball&&(o.ball.active=!1),o.setLiftExtrasActive(!1);n?n():l&&(t?o.scheduleOnce((function(){o.onStart(!1)}),.5):o.scheduleOnce((function(){o.onStart(!1)}),1))}else o.liftJarAndReveal(e,e,!0,n,l,!1)}),.9)}),D)}),.6)}),T)}},a.updateDifficulty=function(){this.swapsPerRound=this.baseSwapsPerRound+this.consecutiveWins,this.swapSpeed=Math.max(.15,this.baseSwapSpeed/(1+.12*this.consecutiveWins)),console.log("Difficulty updated: consecutiveWins =",this.consecutiveWins,"swapSpeed =",this.swapSpeed,"swapsPerRound =",this.swapsPerRound)},a.resetDifficulty=function(){this.swapsPerRound=this.baseSwapsPerRound,this.swapSpeed=this.baseSwapSpeed,console.log("Difficulty reset to initial: swapSpeed =",this.swapSpeed,"swapsPerRound =",this.swapsPerRound)},a.placeBallUnderCup=function(i){if(this.ball&&this.cups[i]){var e=this.cups[i].position.clone();e.y=this.ballYPosition,this.ball.setPosition(e)}},a.placeBall2UnderCup=function(i){if(this.ball2&&this.cups[i]){var e=this.cups[i].position.clone();e.y=this.ballYPosition,this.ball2.setPosition(e)}},a.updateCoinDisplay=function(){this.coinLabel?(this.coinLabel.node&&(this.coinLabel.node.active=!0),this.coinLabel.string=""+this.currentCoins,console.log("Coins updated: "+this.currentCoins)):console.warn("Coin Label not assigned! Please assign a Label component in the inspector.")},a.shuffleCups=function(i,e){var t=this;if(i<=0)return this.resetHands(),void e();for(var n=d.randomRangeInt(0,this.cups.length),l=d.randomRangeInt(0,this.cups.length);l===n;)l=d.randomRangeInt(0,this.cups.length);var a=this.cups[n],s=this.cups[l],o=a.position.clone(),r=s.position.clone(),c=this.hands.length>0?this.hands[0]:null,u=this.hands.length>1?this.hands[1]:this.hands.length>0?this.hands[0]:null,h=function(i){var e=i.getComponent(g);if(e){var t=e.contentSize,n=e.anchorPoint,l=i.worldScale;return i.position.y+t.height*(1-n.y)*l.y}return i.position.y+50},p=h(a),f=h(s),b=new v(o.x,p+this.handGrabHeight,o.z),C=new v(r.x,f+this.handGrabHeight,r.z),w=new v(r.x,f+this.handGrabHeight,r.z),y=new v(o.x,p+this.handGrabHeight,o.z),S=.3*this.swapSpeed,x=.5*this.swapSpeed,I=.2*this.swapSpeed;if(c&&u){var A=c.position.clone(),k=u.position.clone(),z=Math.max(p,f);A.y=Math.max(A.y,z+this.handGrabHeight),k.y=Math.max(k.y,z+this.handGrabHeight);var P=m(a).to(x,{position:r},{easing:"sineInOut"}),L=m(s).to(x,{position:o},{easing:"sineInOut"}),O=m(c).to(S,{position:b},{easing:"sineOut"}),R=m(c).to(x,{position:w},{easing:"sineInOut"}),E=m(c).to(I,{position:A},{easing:"sineIn"}),T=m(u).to(S,{position:C},{easing:"sineOut"}),D=m(u).to(x,{position:y},{easing:"sineInOut"}),U=m(u).to(I,{position:k},{easing:"sineIn"});m(this.node).call((function(){O.start(),T.start()})).delay(S).call((function(){P.start(),L.start(),R.start(),D.start()})).delay(x).call((function(){E.start(),U.start()})).delay(I+.05).call((function(){t.cups[n]=s,t.cups[l]=a;var o=a?a.name.toLowerCase().trim():"",r=s?s.name.toLowerCase().trim():"",c=o.includes("001"),u=r.includes("001");if(c?(t.ballIndex=l,t.ballCup=a):u&&(t.ballIndex=n,t.ballCup=s),t.enableDoubleBalls&&t.ball2JarName){var h=t.ball2JarName.toLowerCase().trim();h===o||o.includes(h)?(t.ball2Index=l,t.ball2Cup=a):(h===r||r.includes(h))&&(t.ball2Index=n,t.ball2Cup=s)}t.shuffleCups(i-1,e)})).start()}else{var F=m(a).to(this.swapSpeed,{position:r},{easing:"sineInOut"}),j=m(s).to(this.swapSpeed,{position:o},{easing:"sineInOut"});m(this.node).call((function(){F.start(),j.start()})).delay(this.swapSpeed+.02).call((function(){t.cups[n]=s,t.cups[l]=a;var o=a?a.name.toLowerCase().trim():"",r=s?s.name.toLowerCase().trim():"",c=o.includes("001"),u=r.includes("001");if(c?(t.ballIndex=l,t.ballCup=a):u&&(t.ballIndex=n,t.ballCup=s),t.enableDoubleBalls&&t.ball2JarName){var h=t.ball2JarName.toLowerCase().trim();h===o||o.includes(h)?(t.ball2Index=l,t.ball2Cup=a):(h===r||r.includes(h))&&(t.ball2Index=n,t.ball2Cup=s)}t.shuffleCups(i-1,e)})).start()}},a.resetHands=function(){if(this.hands.length>0&&this.hands[0].initialPosition)for(var i=0;i<this.hands.length;i++)this.hands[i]&&this.hands[i].initialPosition&&this.hands[i].setPosition(this.hands[i].initialPosition)},a.highlightCup=function(i){if(this.clearHighlights(),i){var e=i.getComponent(w);e&&(e.color=this.highlightColor,this.highlightedCup=i)}},a.clearHighlights=function(){if(this.highlightedCup){var i=this.highlightedCup.getComponent(w);i&&(i.color=c.WHITE),this.highlightedCup=null}},a.setLiftExtrasActive=function(i){for(var e=0;e<this.liftExtras.length;e++)this.liftExtras[e]&&(this.liftExtras[e].active=i)},a.startIdleAnimations=function(){this.stopIdleAnimations();for(var i=0;i<this.hands.length;i++){var e=this.hands[i];if(e){var t=e.initialPosition||e.position.clone();e.initialPosition||(e.initialPosition=t.clone());var n=(i%2==0?1:-1)*this.idleAnimationAmplitude*.5,l=this.idleAnimationAmplitude,a=m(e).to(this.idleAnimationSpeed,{position:new v(t.x+n,t.y+l,t.z)},{easing:"sineInOut"}).to(this.idleAnimationSpeed,{position:new v(t.x-n,t.y-l,t.z)},{easing:"sineInOut"}).union().repeatForever().start();this.idleTweens.push(a)}}},a.stopIdleAnimations=function(){for(var i=0;i<this.idleTweens.length;i++)this.idleTweens[i]&&this.idleTweens[i].stop();this.idleTweens=[],this.resetHands()},e}(S)).prototype,"cups",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=e(D.prototype,"hands",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),j=e(D.prototype,"ball",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(D.prototype,"ball2",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(D.prototype,"resultLabel",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=e(D.prototype,"coinLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=e(D.prototype,"enableDoubleBalls",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),J=e(D.prototype,"startingCoins",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),B=e(D.prototype,"swapsPerRound",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),_=e(D.prototype,"swapSpeed",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.35}}),W=e(D.prototype,"handGrabHeight",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 80}}),Y=e(D.prototype,"idleAnimationAmplitude",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),V=e(D.prototype,"idleAnimationSpeed",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.5}}),K=e(D.prototype,"jarLiftHeight",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 80}}),X=e(D.prototype,"jarTiltAngle",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 15}}),q=e(D.prototype,"liftExtras",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Z=e(D.prototype,"ballRevealDuration",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.6}}),Q=e(D.prototype,"ballYPosition",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-90}}),$=e(D.prototype,"clickCalibrationOffsetX",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ii=e(D.prototype,"clickCalibrationOffsetY",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ei=e(D.prototype,"jar0ClickAreaLeft",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ti=e(D.prototype,"jar0ClickAreaRight",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ni=e(D.prototype,"jar1ClickAreaLeft",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),li=e(D.prototype,"jar1ClickAreaRight",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ai=e(D.prototype,"jar2ClickAreaLeft",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),si=e(D.prototype,"jar2ClickAreaRight",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),oi=e(D.prototype,"showClickableAreas",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),ri=e(D.prototype,"highlightColor",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c(255,105,180,160)}}),ci=e(D.prototype,"clickableAreaColor",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c(0,255,0,100)}}),T=D))||T));a._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./CupShuffleGame.ts"],(function(){return{setters:[null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});